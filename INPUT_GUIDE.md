# 输入体验优化指南

## 问题描述

如果您在使用脚本时看到类似 `^[[C`、`^[[D` 这样的字符，这是因为您的终端环境不完全支持方向键输入。这些是ANSI转义序列，当终端无法正确处理方向键时就会显示原始的转义码。

## 解决方案

### 1. 自动解决（推荐）

脚本已经内置了输入过滤功能：
- ✅ 自动过滤ANSI转义序列
- ✅ 自动过滤控制字符
- ✅ 保留有效输入内容

即使看到 `^[[C` 字符，最终输入的内容仍然是正确的。

### 2. 安装 rlwrap（最佳体验）

rlwrap 可以提供完整的行编辑功能，包括：
- ✅ 方向键支持
- ✅ 输入历史记录
- ✅ 退格键正常工作
- ✅ 复制粘贴支持

**安装命令：**

```bash
# Ubuntu/Debian
sudo apt-get install rlwrap

# CentOS/RHEL (旧版本)
sudo yum install rlwrap

# CentOS/RHEL/Fedora (新版本)
sudo dnf install rlwrap

# Arch Linux
sudo pacman -S rlwrap
```

### 3. 使用技巧

如果暂时无法安装 rlwrap，请遵循以下使用技巧：

#### ✅ 推荐做法
- 直接输入内容，不使用方向键
- 输入错误时使用 `Ctrl+C` 重新开始
- 复制粘贴长文本内容
- 使用 Tab 键（如果支持）

#### ❌ 避免操作
- 不要使用方向键移动光标
- 不要使用 Home/End 键
- 不要使用 Page Up/Down 键
- 避免在输入过程中使用功能键

## 输入示例

### 正常输入
```
请输入服务名称: my-service
```

### 包含转义字符的输入
```
请输入服务名称: my^[[C^[[D-service
```
实际保存的内容：`my-service`（转义字符已被过滤）

## 终端兼容性

### ✅ 完全支持的终端
- 现代 Linux 终端（GNOME Terminal、Konsole 等）
- macOS Terminal
- Windows Terminal
- VS Code 集成终端

### ⚠️ 部分支持的终端
- 某些 SSH 客户端
- 简化的终端环境
- 嵌入式系统终端

### ❌ 不支持的环境
- 纯文本控制台（无图形界面）
- 某些旧版本的终端模拟器

## 故障排除

### 问题：输入时出现乱码
**解决方案：**
1. 检查终端编码设置（推荐 UTF-8）
2. 尝试安装 rlwrap
3. 使用不同的终端应用

### 问题：无法删除输入的字符
**解决方案：**
1. 使用 `Ctrl+C` 重新开始输入
2. 安装 rlwrap 获得完整编辑功能
3. 直接输入正确内容，不要尝试修改

### 问题：复制粘贴不工作
**解决方案：**
1. 使用终端的右键菜单
2. 使用 `Ctrl+Shift+V`（Linux）或 `Cmd+V`（macOS）
3. 确保粘贴的内容不包含特殊字符

## 技术说明

脚本使用以下技术改善输入体验：

1. **输入过滤**：自动移除ANSI转义序列
2. **字符清理**：过滤控制字符和不可见字符
3. **rlwrap 集成**：自动检测并使用 rlwrap（如果可用）
4. **终端优化**：设置合理的终端属性

## 反馈

如果您遇到其他输入相关的问题，请提供以下信息：
- 操作系统版本
- 终端应用名称和版本
- 具体的错误现象
- 是否安装了 rlwrap
